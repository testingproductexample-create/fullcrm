import React, { useState } from 'react';
import { useTranslation } from 'react-i18next';
import {
  Settings as SettingsIcon,
  User,
  Bell,
  Shield,
  Database,
  Globe,
  Monitor,
  Key,
  Mail,
  Smartphone,
  Eye,
  Save,
  RefreshCw
} from 'lucide-react';

const Settings = () => {
  const { t, i18n } = useTranslation();
  const [activeTab, setActiveTab] = useState('profile');
  const [settings, setSettings] = useState({
    language: i18n.language,
    theme: 'dark',
    notifications: {
      email: true,
      push: false,
      sms: false,
      reports: true,
      alerts: true
    },
    privacy: {
      profileVisibility: 'team',
      dataRetention: '2years',
      analytics: true
    },
    dashboard: {
      autoRefresh: true,
      refreshInterval: 30,
      defaultView: 'overview'
    }
  });

  const tabs = [
    { id: 'profile', name: 'Profile', icon: User },
    { id: 'notifications', name: 'Notifications', icon: Bell },
    { id: 'privacy', name: 'Privacy', icon: Shield },
    { id: 'dashboard', name: 'Dashboard', icon: Monitor },
    { id: 'system', name: 'System', icon: Database },
  ];

  const handleSettingChange = (category, key, value) => {
    setSettings(prev => ({
      ...prev,
      [category]: {
        ...prev[category],
        [key]: value
      }
    }));
  };

  const handleSave = () => {
    // Save settings logic here
    alert('Settings saved successfully!');
  };

  const TabContent = () => {
    switch (activeTab) {
      case 'profile':
        return (
          <div className="space-y-6">
            <div>
              <h3 className="text-lg font-semibold text-white mb-4">Profile Information</h3>
              <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                  <label className="block text-white font-medium mb-2">First Name</label>
                  <input
                    type="text"
                    defaultValue="Admin"
                    className="glass-input w-full"
                  />
                </div>
                <div>
                  <label className="block text-white font-medium mb-2">Last Name</label>
                  <input
                    type="text"
                    defaultValue="User"
                    className="glass-input w-full"
                  />
                </div>
                <div>
                  <label className="block text-white font-medium mb-2">Email</label>
                  <input
                    type="email"
                    defaultValue="admin@company.com"
                    className="glass-input w-full"
                  />
                </div>
                <div>
                  <label className="block text-white font-medium mb-2">Department</label>
                  <input
                    type="text"
                    defaultValue="Operations"
                    className="glass-input w-full"
                  />
                </div>
              </div>
            </div>

            <div>
              <h3 className="text-lg font-semibold text-white mb-4">Change Password</h3>
              <div className="space-y-4">
                <div>
                  <label className="block text-white font-medium mb-2">Current Password</label>
                  <input
                    type="password"
                    className="glass-input w-full"
                  />
                </div>
                <div>
                  <label className="block text-white font-medium mb-2">New Password</label>
                  <input
                    type="password"
                    className="glass-input w-full"
                  />
                </div>
                <div>
                  <label className="block text-white font-medium mb-2">Confirm Password</label>
                  <input
                    type="password"
                    className="glass-input w-full"
                  />
                </div>
              </div>
            </div>
          </div>
        );

      case 'notifications':
        return (
          <div className="space-y-6">
            <div>
              <h3 className="text-lg font-semibold text-white mb-4">Notification Preferences</h3>
              
              <div className="space-y-4">
                <div className="glass p-4 rounded-lg">
                  <h4 className="text-white font-medium mb-3">Notification Methods</h4>
                  <div className="space-y-3">
                    <label className="flex items-center justify-between">
                      <div className="flex items-center space-x-3">
                        <Mail className="h-5 w-5 text-blue-400" />
                        <span className="text-white">Email Notifications</span>
                      </div>
                      <input
                        type="checkbox"
                        checked={settings.notifications.email}
                        onChange={(e) => handleSettingChange('notifications', 'email', e.target.checked)}
                        className="w-4 h-4"
                      />
                    </label>

                    <label className="flex items-center justify-between">
                      <div className="flex items-center space-x-3">
                        <Smartphone className="h-5 w-5 text-green-400" />
                        <span className="text-white">Push Notifications</span>
                      </div>
                      <input
                        type="checkbox"
                        checked={settings.notifications.push}
                        onChange={(e) => handleSettingChange('notifications', 'push', e.target.checked)}
                        className="w-4 h-4"
                      />
                    </label>

                    <label className="flex items-center justify-between">
                      <div className="flex items-center space-x-3">
                        <Mail className="h-5 w-5 text-yellow-400" />
                        <span className="text-white">SMS Notifications</span>
                      </div>
                      <input
                        type="checkbox"
                        checked={settings.notifications.sms}
                        onChange={(e) => handleSettingChange('notifications', 'sms', e.target.checked)}
                        className="w-4 h-4"
                      />
                    </label>
                  </div>
                </div>

                <div className="glass p-4 rounded-lg">
                  <h4 className="text-white font-medium mb-3">Alert Types</h4>
                  <div className="space-y-3">
                    <label className="flex items-center justify-between">
                      <span className="text-white">Report Generation Complete</span>
                      <input
                        type="checkbox"
                        checked={settings.notifications.reports}
                        onChange={(e) => handleSettingChange('notifications', 'reports', e.target.checked)}
                        className="w-4 h-4"
                      />
                    </label>

                    <label className="flex items-center justify-between">
                      <span className="text-white">Performance Alerts</span>
                      <input
                        type="checkbox"
                        checked={settings.notifications.alerts}
                        onChange={(e) => handleSettingChange('notifications', 'alerts', e.target.checked)}
                        className="w-4 h-4"
                      />
                    </label>
                  </div>
                </div>
              </div>
            </div>
          </div>
        );

      case 'privacy':
        return (
          <div className="space-y-6">
            <div>
              <h3 className="text-lg font-semibold text-white mb-4">Privacy Settings</h3>
              
              <div className="space-y-4">
                <div className="glass p-4 rounded-lg">
                  <h4 className="text-white font-medium mb-3">Profile Visibility</h4>
                  <select
                    value={settings.privacy.profileVisibility}
                    onChange={(e) => handleSettingChange('privacy', 'profileVisibility', e.target.value)}
                    className="glass-select w-full"
                  >
                    <option value="public">Public</option>
                    <option value="team">Team Only</option>
                    <option value="private">Private</option>
                  </select>
                </div>

                <div className="glass p-4 rounded-lg">
                  <h4 className="text-white font-medium mb-3">Data Retention</h4>
                  <select
                    value={settings.privacy.dataRetention}
                    onChange={(e) => handleSettingChange('privacy', 'dataRetention', e.target.value)}
                    className="glass-select w-full"
                  >
                    <option value="1year">1 Year</option>
                    <option value="2years">2 Years</option>
                    <option value="5years">5 Years</option>
                    <option value="indefinite">Indefinite</option>
                  </select>
                </div>

                <div className="glass p-4 rounded-lg">
                  <h4 className="text-white font-medium mb-3">Analytics & Usage</h4>
                  <label className="flex items-center justify-between">
                    <span className="text-white">Allow analytics data collection</span>
                    <input
                      type="checkbox"
                      checked={settings.privacy.analytics}
                      onChange={(e) => handleSettingChange('privacy', 'analytics', e.target.checked)}
                      className="w-4 h-4"
                    />
                  </label>
                </div>
              </div>
            </div>
          </div>
        );

      case 'dashboard':
        return (
          <div className="space-y-6">
            <div>
              <h3 className="text-lg font-semibold text-white mb-4">Dashboard Preferences</h3>
              
              <div className="space-y-4">
                <div className="glass p-4 rounded-lg">
                  <h4 className="text-white font-medium mb-3">Auto Refresh</h4>
                  <label className="flex items-center justify-between mb-3">
                    <span className="text-white">Enable automatic data refresh</span>
                    <input
                      type="checkbox"
                      checked={settings.dashboard.autoRefresh}
                      onChange={(e) => handleSettingChange('dashboard', 'autoRefresh', e.target.checked)}
                      className="w-4 h-4"
                    />
                  </label>
                  
                  {settings.dashboard.autoRefresh && (
                    <div>
                      <label className="block text-white font-medium mb-2">Refresh Interval (seconds)</label>
                      <input
                        type="number"
                        min="10"
                        max="300"
                        value={settings.dashboard.refreshInterval}
                        onChange={(e) => handleSettingChange('dashboard', 'refreshInterval', parseInt(e.target.value))}
                        className="glass-input w-full"
                      />
                    </div>
                  )}
                </div>

                <div className="glass p-4 rounded-lg">
                  <h4 className="text-white font-medium mb-3">Default View</h4>
                  <select
                    value={settings.dashboard.defaultView}
                    onChange={(e) => handleSettingChange('dashboard', 'defaultView', e.target.value)}
                    className="glass-select w-full"
                  >
                    <option value="overview">Overview</option>
                    <option value="employee">Employee Performance</option>
                    <option value="resource">Resource Utilization</option>
                    <option value="workflow">Workflow Analytics</option>
                  </select>
                </div>
              </div>
            </div>
          </div>
        );

      case 'system':
        return (
          <div className="space-y-6">
            <div>
              <h3 className="text-lg font-semibold text-white mb-4">System Settings</h3>
              
              <div className="space-y-4">
                <div className="glass p-4 rounded-lg">
                  <h4 className="text-white font-medium mb-3">Language & Region</h4>
                  <div className="space-y-3">
                    <div>
                      <label className="block text-white font-medium mb-2">Language</label>
                      <select
                        value={settings.language}
                        onChange={(e) => {
                          setSettings(prev => ({ ...prev, language: e.target.value }));
                          i18n.changeLanguage(e.target.value);
                        }}
                        className="glass-select w-full"
                      >
                        <option value="en">English</option>
                        <option value="ar">العربية (Arabic)</option>
                      </select>
                    </div>
                  </div>
                </div>

                <div className="glass p-4 rounded-lg">
                  <h4 className="text-white font-medium mb-3">System Maintenance</h4>
                  <div className="space-y-3">
                    <button className="w-full glass-button py-3 flex items-center justify-center space-x-2">
                      <RefreshCw className="h-4 w-4" />
                      <span>Clear Cache</span>
                    </button>
                    <button className="w-full glass-button py-3 flex items-center justify-center space-x-2">
                      <Database className="h-4 w-4" />
                      <span>Optimize Database</span>
                    </button>
                  </div>
                </div>

                <div className="glass p-4 rounded-lg">
                  <h4 className="text-white font-medium mb-3">API Keys</h4>
                  <div className="space-y-3">
                    <div className="flex justify-between items-center">
                      <span className="text-white">Primary API Key</span>
                      <button className="glass-button px-3 py-1 text-sm">Regenerate</button>
                    </div>
                    <div className="flex justify-between items-center">
                      <span className="text-white">Secondary API Key</span>
                      <button className="glass-button px-3 py-1 text-sm">View</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        );

      default:
        return null;
    }
  };

  return (
    <div className="space-y-6">
      {/* Header */}
      <div className="fade-in">
        <h1 className="text-3xl font-bold text-white mb-2">
          {t('nav.settings')}
        </h1>
        <p className="text-gray-400">Configure your analytics dashboard and account preferences</p>
      </div>

      <div className="grid grid-cols-1 lg:grid-cols-4 gap-6">
        {/* Sidebar */}
        <div className="lg:col-span-1">
          <div className="glass-card p-4">
            <nav className="space-y-2">
              {tabs.map((tab) => {
                const Icon = tab.icon;
                return (
                  <button
                    key={tab.id}
                    onClick={() => setActiveTab(tab.id)}
                    className={`w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-all ${
                      activeTab === tab.id
                        ? 'bg-blue-500/20 text-blue-400 border border-blue-400/30'
                        : 'text-gray-300 hover:bg-white/10 hover:text-white'
                    }`}
                  >
                    <Icon className="h-5 w-5" />
                    <span>{tab.name}</span>
                  </button>
                );
              })}
            </nav>
          </div>
        </div>

        {/* Content */}
        <div className="lg:col-span-3">
          <div className="glass-card p-6">
            <TabContent />
            
            <div className="flex justify-end space-x-4 mt-8 pt-6 border-t border-white/10">
              <button className="glass-button px-6 py-3 font-medium">
                Reset to Defaults
              </button>
              <button
                onClick={handleSave}
                className="glass-button px-6 py-3 font-medium flex items-center space-x-2"
              >
                <Save className="h-4 w-4" />
                <span>Save Changes</span>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
};

export default Settings;